from pathlib import Path

OBJECT_TO_BACKUP = '/home/server/data.db'
BACKUP_DIRECTORY = '/home/server/backup'
MAX_BACKUP_AMOUNT = 5

object_to_backup_path = Path(OBJECT_TO_BACKUP) 
backup_directory_path = Path(BACKUP_DIRECTORY)
assert object_to_backup_path.exists()

backup_directory_path.mkdir(parents=True, exists_ok=True) 

existing_backups = [
    x for x in backup_directory_path.iterdir()
    if x.is_file() and x.name.startswith('backup-') 
   ]

oldest_to_newest_backup_by_name = list(sorted(existing_backups, key=lambda f: f.name))
while len(oldest_to_newest_backup_by_name) >= MAX_BACKUP_AMOUNT:
    backup_to_delete = oldest_to_newest_backup_by_name.pop(0)
    backup_to_delete.unlink() 
